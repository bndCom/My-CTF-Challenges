import hashlib
import os
import sys

def md5hash(filename):
	return hashlib.md5(open(filename, "rb").read()).hexdigest()

# reading the hashes of the backup
with open("/home/ctf/backup", "r") as f:
    hashes = f.read().splitlines()


#folder_path = sys.argv[1]
folder_path = "/usr/bin/"

for filename in os.listdir(folder_path):
    file_path = os.path.join(folder_path, filename)
    if os.path.isfile(file_path):
        hash_to_check = md5hash(file_path)
        if hash_to_check not in hashes:
            print("suspicious file: {}".format(file_path))
            break
